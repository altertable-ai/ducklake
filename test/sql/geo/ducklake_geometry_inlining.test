# name: test/sql/geo/ducklake_geometry_inlining.test
# group: [geo]

require ducklake

require parquet

require spatial

test-env DUCKLAKE_CONNECTION __TEST_DIR__/{UUID}.db

test-env DATA_PATH __TEST_DIR__

statement ok
ATTACH 'ducklake:${DUCKLAKE_CONNECTION}' AS ducklake (
	DATA_PATH '${DATA_PATH}/ducklake_files',
	METADATA_CATALOG 'ducklake_meta',
	DATA_INLINING_ROW_LIMIT 5
)

statement ok
USE ducklake;

statement ok
create table t1 (g GEOMETRY);

statement ok
insert into t1 VALUES (ST_POINT(1,2));

query I
SELECT * FROM t1;
----
POINT (1 2)

statement ok
create table t2 as select ST_POINT(1,2) as g;

statement ok
insert into t1 VALUES (ST_POINT(1,2));

statement ok
insert into t1 VALUES (ST_POINT(1,2));

statement ok
insert into t1 VALUES (ST_POINT(1,2));

statement ok
insert into t1 VALUES (ST_POINT(1,2));

statement ok
insert into t1 VALUES (ST_POINT(1,2));

query I
SELECT COUNT(*) FROM t1;
----
6